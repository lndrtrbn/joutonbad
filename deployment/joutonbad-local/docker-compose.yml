version: "3"

volumes:
  mongo_data:

services:
  mongo-primary:
    container_name: mongo-primary
    image: bitnami/mongodb:4.2.21
    restart: always
    environment:
      MONGODB_ADVERTISED_HOSTNAME: mongo-primary
      MONGODB_REPLICA_SET_MODE: primary
      MONGODB_REPLICA_SET_KEY: replicasetkey123
      MONGODB_ROOT_USER: root
      MONGODB_ROOT_PASSWORD: root
    volumes:
      - mongo_data:/bitnami/mongodb
    ports:
      - 27018:27017

  mongo-secondary:
    container_name: mongo-secondary
    image: bitnami/mongodb:4.2.21
    depends_on:
      - mongo-primary
    restart: always
    environment:
      MONGODB_ADVERTISED_HOSTNAME: mongo-secondary
      MONGODB_REPLICA_SET_MODE: secondary
      MONGODB_REPLICA_SET_KEY: replicasetkey123
      MONGODB_INITIAL_PRIMARY_HOST: mongo-primary
      MONGODB_INITIAL_PRIMARY_PORT_NUMBER: 27017
      MONGODB_INITIAL_PRIMARY_ROOT_PASSWORD: root
